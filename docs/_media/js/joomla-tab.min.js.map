{"version":3,"file":"joomla-tab.min.js","sources":["../../../src/js/tab/tab.js"],"sourcesContent":["(() => {\n  customElements.define('joomla-tab', class extends HTMLElement {\n    /* Attributes to monitor */\n    static get observedAttributes() { return ['recall', 'orientation', 'view']; }\n\n    get recall() { return this.getAttribute('recall'); }\n\n    get view() { return this.getAttribute('view'); }\n\n    set view(value) { this.setAttribute('view', value); }\n\n    get orientation() { return this.getAttribute('orientation'); }\n\n    set orientation(value) { this.setAttribute('orientation', value); }\n\n    /* Lifecycle, element created */\n    constructor() {\n      super();\n\n      this.hasActive = false;\n      this.currentActive = '';\n      this.hasNested = false;\n      this.isNested = false;\n      this.tabs = [];\n    }\n\n    /* Lifecycle, element appended to the DOM */\n    connectedCallback() {\n      if (!this.orientation || (this.orientation && ['horizontal', 'vertical'].indexOf(this.orientation) === -1)) {\n        this.orientation = 'horizontal';\n      }\n\n      // get tab elements\n      const self = this;\n      const tabs = [].slice.call(this.querySelectorAll('section'));\n      let tabsEl = [];\n      const tabLinkHash = [];\n\n      // Sanity check\n      if (!tabs) {\n        return;\n      }\n\n      if (this.parentNode.closest('joomla-tab')) {\n        this.isNested = true;\n      }\n\n      if (this.querySelector('joomla-tab')) {\n        this.hasNested = true;\n      }\n\n      // Use the sessionStorage state!\n      if (this.hasAttribute('recall')) {\n        const href = sessionStorage.getItem(this.getStorageKey());\n        if (href) {\n          tabLinkHash.push(href);\n        }\n      }\n\n      if (this.hasNested) {\n        // @todo use the recall attribute\n        const href = sessionStorage.getItem(this.getStorageKey());\n        if (href) {\n          tabLinkHash.push(href);\n        }\n        // @todo end\n\n        // Add possible parent tab to the aray for activation\n        if (tabLinkHash.length && tabLinkHash[0] !== '') {\n          const hash = tabLinkHash[0].substring(5);\n          const element = this.querySelector(`#${hash}`);\n\n          // Add the parent tab to the array for activation\n          if (element) {\n            const currentTabSet = element.closest('joomla-tab');\n\n            if (this.isNested) {\n              const parentTab = currentTabSet.closest('section');\n\n              if (parentTab) {\n                tabLinkHash.push(`#tab-${parentTab.id}`);\n              }\n            }\n          }\n        }\n\n        // remove the cascaded tabs and activate the right tab\n        tabs.forEach((tab) => {\n          if (tabLinkHash.length) {\n            const theId = `#tab-${tab.id}`;\n\n            if (tabLinkHash.indexOf(theId) === -1) {\n              tab.removeAttribute('active');\n            } else {\n              tab.setAttribute('active', '');\n            }\n          }\n\n          if (tab.parentNode === self) {\n            tabsEl.push(tab);\n          }\n        });\n      } else {\n        // Activate the correct tab\n        tabs.forEach((tab) => {\n          if (tabLinkHash.length) {\n            const theId = `#tab-${tab.id}`;\n            if (tabLinkHash.indexOf(theId) === -1) {\n              tab.removeAttribute('active');\n            } else {\n              tab.setAttribute('active', '');\n            }\n          }\n        });\n\n        tabsEl = tabs;\n      }\n\n      // Create the navigation\n      if (this.view !== 'accordion') {\n        this.createNavigation(tabsEl);\n      }\n\n      // Add missing role\n      tabsEl.forEach((tab) => {\n        tab.setAttribute('role', 'tabpanel');\n        this.tabs.push(`#tab-${tab.id}`);\n        if (tab.hasAttribute('active')) {\n          this.hasActive = true;\n          this.currentActive = tab.id;\n          this.querySelector(`#tab-${tab.id}`).setAttribute('aria-selected', 'true');\n          this.querySelector(`#tab-${tab.id}`).setAttribute('active', '');\n          this.querySelector(`#tab-${tab.id}`).setAttribute('tabindex', '0');\n        }\n      });\n\n      // Fallback if no active tab\n      if (!this.hasActive) {\n        tabsEl[0].setAttribute('active', '');\n        tabsEl[0].removeAttribute('aria-hidden');\n        this.hasActive = true;\n        this.currentActive = tabsEl[0].id;\n        this.querySelector(`#tab-${tabsEl[0].id}`).setAttribute('aria-selected', 'true');\n        this.querySelector(`#tab-${tabsEl[0].id}`).setAttribute('tabindex', '0');\n        this.querySelector(`#tab-${tabsEl[0].id}`).setAttribute('active', '');\n      }\n\n      // Check if there is a hash in the URI\n      if (window.location.href.match(/#\\S[^&]*/)) {\n        const hash = window.location.href.match(/#\\S[^&]*/);\n        const element = this.querySelector(hash[0]);\n\n        if (element) {\n          // Activate any parent tabs (nested tables)\n          const currentTabSet = element.closest('joomla-tab');\n\n          if (this.isNested) {\n            const parentTabSet = currentTabSet.closest('joomla-tab');\n            const parentTab = currentTabSet.closest('section');\n            parentTabSet.showTab(parentTab);\n            // Now activate the given tab\n            this.show(element);\n          } else {\n            // Now activate the given tab\n            this.showTab(element);\n          }\n        }\n      }\n\n      // Convert tabs to accordian\n      self.checkView(self);\n      window.addEventListener('resize', () => {\n        self.checkView(self);\n      });\n    }\n\n    /* Lifecycle, element removed from the DOM */\n    disconnectedCallback() {\n      const ulEl = this.querySelector('ul');\n      const navigation = [].slice.call(ulEl.querySelectorAll('a'));\n\n      navigation.forEach((link) => {\n        link.removeEventListener('click', this);\n      });\n      ulEl.removeEventListener('keydown', this);\n    }\n\n    /* Method to create the tabs navigation */\n    createNavigation(tabs) {\n      if (this.firstElementChild.nodeName.toLowerCase() === 'ul') {\n        return;\n      }\n\n      const nav = document.createElement('ul');\n      nav.setAttribute('role', 'tablist');\n\n      /** Activate Tab */\n      const activateTabFromLink = (e) => {\n        e.preventDefault();\n\n        // Doing toggle for accordion\n        const justHide = this.view === 'accordion' && e.target.hasAttribute('active');\n\n        if (this.hasActive) {\n          this.hideCurrent();\n\n          if (justHide) {\n            this.hasActive = false;\n            return;\n          }\n        }\n\n        const currentTabLink = this.currentActive;\n\n        // Set the selected tab as active\n        // Emit show event\n        this.dispatchCustomEvent('joomla.tab.show', e.target, this.querySelector(`#tab-${currentTabLink}`));\n        e.target.setAttribute('active', '');\n        e.target.setAttribute('aria-selected', 'true');\n        e.target.setAttribute('tabindex', '0');\n        this.querySelector(e.target.hash).setAttribute('active', '');\n        this.querySelector(e.target.hash).removeAttribute('aria-hidden');\n        this.currentActive = e.target.hash.substring(1);\n        // Emit shown event\n        this.dispatchCustomEvent('joomla.tab.shown', e.target, this.querySelector(`#tab-${currentTabLink}`));\n        this.saveState(`#tab-${e.target.hash.substring(1)}`);\n        this.hasActive = true;\n      };\n\n      tabs.forEach((tab) => {\n        if (!tab.id) {\n          return;\n        }\n\n        const active = tab.hasAttribute('active');\n        const liElement = document.createElement('li');\n        const aElement = document.createElement('a');\n\n        liElement.setAttribute('role', 'presentation');\n        aElement.setAttribute('role', 'tab');\n        aElement.setAttribute('aria-controls', tab.id);\n        aElement.setAttribute('aria-selected', active ? 'true' : 'false');\n        aElement.setAttribute('tabindex', active ? '0' : '-1');\n        aElement.setAttribute('href', `#${tab.id}`);\n        aElement.setAttribute('id', `tab-${tab.id}`);\n        aElement.innerHTML = tab.getAttribute('name');\n\n        if (active) {\n          aElement.setAttribute('active', '');\n        }\n\n        aElement.addEventListener('click', activateTabFromLink);\n\n        liElement.appendChild(aElement);\n        nav.appendChild(liElement);\n\n        tab.setAttribute('aria-labelledby', `tab-${tab.id}`);\n        if (!active) {\n          tab.setAttribute('aria-hidden', 'true');\n        }\n      });\n\n      this.insertAdjacentElement('afterbegin', nav);\n\n      // Keyboard access\n      this.addKeyListeners();\n    }\n\n    hideCurrent() {\n      // Unset the current active tab\n      if (this.currentActive) {\n        // Emit hide event\n        const el = this.querySelector(`a[aria-controls=\"${this.currentActive}\"]`);\n        this.dispatchCustomEvent('joomla.tab.hide', el, this.querySelector(`#tab-${this.currentActive}`));\n        el.removeAttribute('active');\n        el.setAttribute('tabindex', '-1');\n        this.querySelector(`#${this.currentActive}`).removeAttribute('active');\n        this.querySelector(`#${this.currentActive}`).setAttribute('aria-hidden', 'true');\n        el.removeAttribute('aria-selected');\n        // Emit hidden event\n        this.dispatchCustomEvent('joomla.tab.hidden', el, this.querySelector(`#tab-${this.currentActive}`));\n      }\n    }\n\n    showTab(tab) {\n      const tabLink = document.querySelector(`#tab-${tab.id}`);\n      tabLink.click();\n    }\n\n    show(ulLink) {\n      ulLink.click();\n    }\n\n    addKeyListeners() {\n      const keyBehaviour = (e) => {\n        // collect tab targets, and their parents' prev/next (or first/last)\n        const currentTab = this.querySelector(`#tab-${this.currentActive}`);\n        // const tablist = [].slice.call(this.querySelector('ul').querySelectorAll('a'));\n\n        const previousTabItem = currentTab.parentNode.previousElementSibling\n          || currentTab.parentNode.parentNode.lastElementChild;\n        const nextTabItem = currentTab.parentNode.nextElementSibling\n          || currentTab.parentNode.parentNode.firstElementChild;\n\n        // don't catch key events when âŒ˜ or Alt modifier is present\n        if (e.metaKey || e.altKey) {\n          return;\n        }\n\n        if (this.tabs.indexOf(`#${document.activeElement.id}`) === -1) {\n          return;\n        }\n\n        // catch left/right and up/down arrow key events\n        switch (e.keyCode) {\n          case 37:\n          case 38:\n            previousTabItem.querySelector('a').click();\n            previousTabItem.querySelector('a').focus();\n            e.preventDefault();\n            break;\n          case 39:\n          case 40:\n            nextTabItem.querySelector('a').click();\n            nextTabItem.querySelector('a').focus();\n            e.preventDefault();\n            break;\n          default:\n            break;\n        }\n      };\n      this.querySelector('ul').addEventListener('keyup', keyBehaviour);\n    }\n\n    getStorageKey() {\n      return window.location.href.toString().split(window.location.host)[1].replace(/&return=[a-zA-Z0-9%]+/, '').split('#')[0];\n    }\n\n    saveState(value) {\n      const storageKey = this.getStorageKey();\n      sessionStorage.setItem(storageKey, value);\n    }\n\n    /** Method to convert tabs to accordion and vice versa depending on screen size */\n    checkView(element) {\n      const el = element;\n      const nav = el.querySelector('ul');\n      const tabsEl = [];\n      if (document.body.getBoundingClientRect().width > 920) {\n        if (this.view === 'tabs') {\n          return;\n        }\n        el.view = 'tabs';\n        // convert to tabs\n        const panels = [].slice.call(nav.querySelectorAll('section'));\n\n        // remove the cascaded tabs\n        for (let i = 0, l = panels.length; i < l; ++i) {\n          if (panels[i].parentNode.parentNode.parentNode === el) {\n            tabsEl.push(panels[i]);\n          }\n        }\n\n        if (tabsEl.length) {\n          tabsEl.forEach((panel) => {\n            el.appendChild(panel);\n          });\n        }\n      } else {\n        if (this.view === 'accordion') {\n          return;\n        }\n        el.view = 'accordion';\n\n        // convert to accordion\n        const panels = [].slice.call(el.querySelectorAll('section'));\n\n        // remove the cascaded tabs\n        for (let i = 0, l = panels.length; i < l; ++i) {\n          if (panels[i].parentNode === el) {\n            tabsEl.push(panels[i]);\n          }\n        }\n\n        if (tabsEl.length) {\n          tabsEl.forEach((panel) => {\n            const link = el.querySelector(`a[aria-controls=\"${panel.id}\"]`);\n            if (link.parentNode.parentNode === el.firstElementChild) {\n              link.parentNode.appendChild(panel);\n            }\n          });\n        }\n      }\n    }\n\n    /* Method to dispatch events */\n    dispatchCustomEvent(eventName, element, related) {\n      const OriginalCustomEvent = new CustomEvent(eventName, { bubbles: true, cancelable: true });\n      OriginalCustomEvent.relatedTarget = related;\n      element.dispatchEvent(OriginalCustomEvent);\n      element.removeEventListener(eventName, element);\n    }\n  });\n})();\n"],"names":["customElements","define","HTMLElement","observedAttributes","recall","this","getAttribute","view","value","setAttribute","orientation","[object Object]","super","hasActive","currentActive","hasNested","isNested","tabs","indexOf","self","slice","call","querySelectorAll","tabsEl","tabLinkHash","parentNode","closest","querySelector","hasAttribute","href","sessionStorage","getItem","getStorageKey","push","length","hash","substring","element","currentTabSet","parentTab","id","forEach","tab","theId","removeAttribute","createNavigation","window","location","match","parentTabSet","showTab","show","checkView","addEventListener","ulEl","link","removeEventListener","firstElementChild","nodeName","toLowerCase","nav","document","createElement","activateTabFromLink","e","preventDefault","justHide","target","hideCurrent","currentTabLink","dispatchCustomEvent","saveState","active","liElement","aElement","innerHTML","appendChild","insertAdjacentElement","addKeyListeners","el","click","ulLink","currentTab","previousTabItem","previousElementSibling","lastElementChild","nextTabItem","nextElementSibling","metaKey","altKey","activeElement","keyCode","focus","toString","split","host","replace","storageKey","setItem","body","getBoundingClientRect","width","panels","i","l","panel","eventName","related","OriginalCustomEvent","CustomEvent","bubbles","cancelable","relatedTarget","dispatchEvent"],"mappings":"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"}