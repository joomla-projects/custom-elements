{"version":3,"file":"joomla-alert.min.js","sources":["../../../src/js/alert/alert.js"],"sourcesContent":["(() => {\n  class JoomlaAlertElement extends HTMLElement {\n    /* Attributes to monitor */\n    static get observedAttributes() { return ['type', 'role', 'dismiss', 'acknowledge', 'href']; }\n\n    get type() { return this.getAttribute('type'); }\n\n    set type(value) { return this.setAttribute('type', value); }\n\n    get role() { return this.getAttribute('role'); }\n\n    set role(value) { return this.setAttribute('role', value); }\n\n    get dismiss() { return this.getAttribute('dismiss'); }\n\n    get autodismiss() { return this.getAttribute('auto-dismiss'); }\n\n    get acknowledge() { return this.getAttribute('acknowledge'); }\n\n    get href() { return this.getAttribute('href'); }\n\n    /* Lifecycle, element appended to the DOM */\n    connectedCallback() {\n      this.classList.add('joomla-alert--show');\n\n      // Default to info\n      if (!this.type || ['info', 'warning', 'danger', 'success'].indexOf(this.type) === -1) {\n        this.setAttribute('type', 'info');\n      }\n      // Default to alert\n      if (!this.role || ['alert', 'alertdialog'].indexOf(this.role) === -1) {\n        this.setAttribute('role', 'alert');\n      }\n      // Append button\n      if ((this.hasAttribute('dismiss') || this.hasAttribute('acknowledge')) || ((this.hasAttribute('href') && this.getAttribute('href') !== '')\n        && !this.querySelector('button.joomla-alert--close') && !this.querySelector('button.joomla-alert-button--close'))) {\n        this.appendCloseButton();\n      }\n\n      if (this.hasAttribute('auto-dismiss')) {\n        this.autoDismiss();\n      }\n\n      this.dispatchCustomEvent('joomla.alert.show');\n    }\n\n    /* Lifecycle, element removed from the DOM */\n    disconnectedCallback() {\n      this.removeEventListener('joomla.alert.show', this);\n      this.removeEventListener('joomla.alert.close', this);\n      this.removeEventListener('joomla.alert.closed', this);\n\n      if (this.firstChild.tagName && this.firstChild.tagName.toLowerCase() === 'button') {\n        this.firstChild.removeEventListener('click', this);\n      }\n    }\n\n    /* Respond to attribute changes */\n    attributeChangedCallback(attr, oldValue, newValue) {\n      switch (attr) {\n        case 'type':\n          if (!newValue || (newValue && ['info', 'warning', 'danger', 'success'].indexOf(newValue) === -1)) {\n            this.type = 'info';\n          }\n          break;\n        case 'role':\n          if (!newValue || (newValue && ['alert', 'alertdialog'].indexOf(newValue) === -1)) {\n            this.role = 'alert';\n          }\n          break;\n        case 'dismiss':\n        case 'acknowledge':\n          if (!newValue || newValue === 'true') {\n            this.appendCloseButton();\n          } else {\n            this.removeCloseButton();\n          }\n          break;\n        case 'auto-dismiss':\n          this.autoDismiss();\n          break;\n        case 'href':\n          if (!newValue || newValue === '') {\n            this.removeCloseButton();\n          } else if (!this.querySelector('button.joomla-alert-button--close')) {\n            this.appendCloseButton();\n          }\n          break;\n        default:\n          break;\n      }\n    }\n\n    markAlertClosed(element) {\n      this.dispatchCustomEvent('joomla.alert.closed');\n      if (element) {\n        element.parentNode.removeChild(element);\n      } else {\n        this.remove();\n      }\n    }\n\n    /* Method to close the alert */\n    close(element = null) {\n      this.dispatchCustomEvent('joomla.alert.close');\n      if (window.matchMedia('(prefers-reduced-motion)').matches) {\n        this.markAlertClosed(element);\n      } else {\n        this.addEventListener('transitionend', () => this.markAlertClosed(element), false);\n      }\n      this.classList.remove('joomla-alert--show');\n    }\n\n    /* Method to dispatch events */\n    dispatchCustomEvent(eventName) {\n      const OriginalCustomEvent = new CustomEvent(eventName);\n      OriginalCustomEvent.relatedTarget = this;\n      this.dispatchEvent(OriginalCustomEvent);\n      this.removeEventListener(eventName, this);\n    }\n\n    /* Method to create the close button */\n    appendCloseButton() {\n      if (this.querySelector('button.joomla-alert--close') || this.querySelector('button.joomla-alert-button--close')) {\n        return;\n      }\n\n      const self = this;\n      const closeButton = document.createElement('button');\n\n      if (this.hasAttribute('dismiss')) {\n        closeButton.classList.add('joomla-alert--close');\n        closeButton.innerHTML = '<span aria-hidden=\"true\">&times;</span>';\n        closeButton.setAttribute('aria-label', this.getText('JCLOSE', 'Close'));\n      } else {\n        closeButton.classList.add('joomla-alert-button--close');\n        if (this.hasAttribute('acknowledge')) {\n          closeButton.innerHTML = this.getText('JOK', 'ok');\n        } else {\n          closeButton.innerHTML = this.getText('JOPEN', 'Open');\n        }\n      }\n\n      if (this.firstChild) {\n        this.insertBefore(closeButton, this.firstChild);\n      } else {\n        this.appendChild(closeButton);\n      }\n\n      /* Add the required listener */\n      if (closeButton) {\n        if (!this.href) {\n          closeButton.addEventListener('click', () => {\n            self.dispatchCustomEvent('joomla.alert.buttonClicked');\n            if (self.getAttribute('data-callback')) {\n              window[self.getAttribute('data-callback')]();\n              self.close();\n            } else {\n              self.close();\n            }\n          });\n        } else {\n          closeButton.addEventListener('click', () => {\n            self.dispatchCustomEvent('joomla.alert.buttonClicked');\n            window.location.href = self.href;\n            self.close();\n          });\n        }\n      }\n    }\n\n    /* Method to auto-dismiss */\n    autoDismiss() {\n      const self = this;\n      setTimeout(() => {\n        self.dispatchCustomEvent('joomla.alert.buttonClicked');\n        if (self.hasAttribute('data-callback')) {\n          window[self.getAttribute('data-callback')]();\n        } else {\n          self.close(self);\n        }\n      }, parseInt(self.getAttribute('auto-dismiss'), 10) ? self.getAttribute('auto-dismiss') : 3000);\n    }\n\n    /* Method to remove the close button */\n    removeCloseButton() {\n      const button = this.querySelector('button');\n      if (button) {\n        button.removeEventListener('click', this);\n        button.parentNode.removeChild(button);\n      }\n    }\n\n    /* Method to get the translated text */\n    getText(str, fallback) {\n      // TODO: Remove coupling to Joomla CMS Core JS here\n      /* eslint-disable-next-line no-undef */\n      return (window.Joomla && Joomla.JText && Joomla.JText._ && typeof Joomla.JText._ === 'function' && Joomla.JText._(str)) ? Joomla.JText._(str) : fallback;\n    }\n  }\n\n  customElements.define('joomla-alert', JoomlaAlertElement);\n})();\n"],"names":["JoomlaAlertElement","HTMLElement","observedAttributes","type","this","getAttribute","value","setAttribute","role","dismiss","autodismiss","acknowledge","href","[object Object]","classList","add","indexOf","hasAttribute","querySelector","appendCloseButton","autoDismiss","dispatchCustomEvent","removeEventListener","firstChild","tagName","toLowerCase","attr","oldValue","newValue","removeCloseButton","element","parentNode","removeChild","remove","window","matchMedia","matches","markAlertClosed","addEventListener","eventName","OriginalCustomEvent","CustomEvent","relatedTarget","dispatchEvent","self","closeButton","document","createElement","innerHTML","getText","insertBefore","appendChild","location","close","setTimeout","parseInt","button","str","fallback","Joomla","JText","_","customElements","define"],"mappings":"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"}