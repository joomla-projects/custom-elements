{"version":3,"file":"joomla-modal-es5.js","sources":["../../../src/js/modal/modal.js"],"sourcesContent":["(() => {\n  // Keycodes\n  const KEYCODE = {\n    TAB: 9,\n    ESC: 27,\n  };\n\n  customElements.define('joomla-modal', class extends HTMLElement {\n    constructor() {\n      super();\n\n      this.triggerBtn = '';\n      this.focusableElements = null;\n      this.focusableSelectors = ['a[href]', 'area[href]', 'input:not([disabled])', 'select:not([disabled])', 'textarea:not([disabled])', 'button:not([disabled])', 'iframe', 'object', 'embed', '[contenteditable]', '[tabindex]:not([tabindex^=\"-\"])'];\n      this.container = this.querySelector('.joomla-modal-dialog');\n    }\n\n    static get observedAttributes() {\n      return ['width', 'height', 'innerWidth', 'innerHeight', 'iframe'];\n    }\n\n    connectedCallback() {\n      if (!this.id) {\n        throw new Error('`Joomla-modal` requires an id');\n      }\n\n      this.title = this.getAttribute('title') || 'Modal';\n      this.setAttribute('role', 'dialog');\n      this.classList.add('fade');\n      this.iframe = this.getAttribute('iframe') || '';\n      this.width = this.getAttribute('width') || '100%';\n      this.height = this.getAttribute('height') || '600px';\n\n      if (!this.container) {\n        const cont = document.createElement('div');\n        cont.classList.add('joomla-modal-dialog');\n        cont.setAttribute('role', 'document');\n        cont.innerHTML = this.innerHTML;\n        this.innerHTML = '';\n        this.appendChild(cont);\n        this.container = this.querySelector('.joomla-modal-dialog');\n      }\n\n      this.header = this.querySelector('header');\n      this.main = this.querySelector('section');\n      this.footer = this.querySelector('footer');\n\n      this.setAttribute('tabindex', -1);\n\n      // Unique Id\n      const randomId = `modal-title-${new Date().getUTCMilliseconds()}`;\n      this.setAttribute('aria-labelledby', randomId);\n\n      if (!this.header) {\n        const htag = document.createElement('h5');\n        htag.innerText = this.title;\n        htag.id = randomId;\n        const closeButton = document.createElement('button');\n        closeButton.setAttribute('aria-label', 'Close');\n        closeButton.setAttribute('data-dismiss', '');\n        closeButton.innerHTML = '<span aria-hidden=\"true\">Ã—</span>';\n\n        const header = document.createElement('header');\n\n        header.appendChild(htag);\n        header.appendChild(closeButton);\n\n        this.container.insertAdjacentElement('afterbegin', header);\n      }\n      this.header = this.container.querySelector('header');\n      this.body = this.container.querySelector('section');\n      this.footer = this.container.querySelector('footer');\n\n      this.triggerBtn = document.querySelector(`[data-href=\"#${this.id}\"]`);\n      if (this.triggerBtn) {\n        this.triggerBtn.addEventListener('click', this.open.bind(this));\n      }\n    }\n\n    disconnectedCallback() {\n      if (this.triggerBtn) {\n        this.triggerBtn.removeEventListener('click', this.open);\n      }\n    }\n\n    open() {\n      const dropShadow = document.createElement('div');\n      dropShadow.classList.add('modal-backdrop', 'fade');\n      dropShadow.classList.add('modal-backdrop', 'show');\n      document.body.appendChild(dropShadow);\n\n      this.removeAttribute('aria-hidden');\n      // Iframe specific code, reload\n      if (this.body) {\n        this.iframeEl = this.main.querySelector('iframe');\n        if (this.iframe) {\n          if (this.iframeEl) {\n            this.iframeEl.parentNode.remove(this.iframeEl);\n          }\n          const newIframe = document.createElement('iframe');\n          newIframe.width = this.width;\n          newIframe.height = this.height;\n          newIframe.src = this.iframe;\n          newIframe.setAttribute('frameborder', 0);\n          this.body.appendChild(newIframe);\n          this.iframeEl = this.main.querySelector('iframe');\n        }\n      }\n\n      // Adjust the dimensions\n      this.adjustDimensions();\n\n      this.scrollTop = 0;\n      this.classList.add('show');\n\n      this.focusableElements = [].slice.call(this.querySelectorAll(this.focusableSelectors.join()));\n      if (this.focusableElements.length) {\n        this.focusableElements[0].focus();\n      } else {\n        this.header.querySelector('button').focus();\n      }\n\n      this.evKeypress = this.keyPress.bind(this);\n      this.evClose = this.close.bind(this);\n      this.evDocumentClose = this.documentClose.bind(this);\n\n      // Keyboard handling\n      this.addEventListener('keydown', this.evKeypress);\n\n      // Close on click outside the modal\n      document.addEventListener('click', this.evDocumentClose);\n\n      // Is there a close button?\n      const modalButtons = [].slice.call(this.querySelectorAll('[data-dismiss]'));\n      // Add listeners for close\n      modalButtons.forEach((modalButton) => {\n        modalButton.addEventListener('click', this.evClose);\n      });\n    }\n\n    close() {\n      this.removeEventListener('keydown', this.evKeypress);\n      document.removeEventListener('click', this.evDocumentClose);\n\n      // Is there a close button?\n      const modalButtons = [].slice.call(this.querySelectorAll('[data-dismiss]'));\n      // Add listeners for close\n      modalButtons.forEach((modalButton) => {\n        modalButton.removeEventListener('click', this.evClose);\n      });\n\n      const dropShadow = document.querySelector('.modal-backdrop');\n      if (dropShadow) document.body.removeChild(dropShadow);\n      this.setAttribute('aria-hidden', 'true');\n      this.classList.remove('show');\n      this.main.innerHTML = '';\n      this.triggerBtn.focus();\n    }\n\n    documentClose(event) {\n      if (!this.findAncestorByClass(event.target, 'joomla-modal-dialog') && event.target !== this.triggerBtn) {\n        this.close();\n      }\n    }\n\n    keyPress(e) {\n      // ESC key\n      if (e.keyCode === KEYCODE.ESC) {\n        this.close();\n      }\n      // TAB key\n      if (e.keyCode === KEYCODE.TAB) {\n        // this.handleTabEvent(e);\n        // Get the index of the current active element within the modal\n        const focusedIndex = this.focusableElements.indexOf(document.activeElement);\n        // Handle TAB event if need to skip\n        // If first element is focused and shift key is in use\n        if (e.shiftKey && (focusedIndex === 0 || focusedIndex === -1)) {\n          // Focus last item within modal\n          this.focusableElements[this.focusableElements.length - 1].focus();\n          e.preventDefault();\n        }\n        // If last element is focused and shift key is not in use\n        if (!e.shiftKey && focusedIndex === this.focusableElements.length - 1) {\n          // Focus first item within modal\n          this.focusableElements[0].focus();\n          e.preventDefault();\n        }\n      }\n    }\n\n    adjustDimensions() {\n      // Legacy code\n      // Height\n      let modalHeight = this.offsetHeight;\n      modalHeight += parseInt(window.getComputedStyle(this).getPropertyValue('margin-top'), 10);\n      modalHeight += parseInt(window.getComputedStyle(this).getPropertyValue('margin-bottom'), 10);\n\n      const bodyHeight = this.body.getBoundingClientRect.height;\n      let bodyHeightOuter = this.body.offsetHeight;\n      bodyHeightOuter += parseInt(window.getComputedStyle(this.body).getPropertyValue('margin-top'), 10);\n      bodyHeightOuter += parseInt(window.getComputedStyle(this.body).getPropertyValue('margin-bottom'), 10);\n\n      let headerHeight = this.header.offsetHeight;\n      headerHeight += parseInt(window.getComputedStyle(this.header).getPropertyValue('margin-top'), 10);\n      headerHeight += parseInt(window.getComputedStyle(this.header).getPropertyValue('margin-bottom'), 10);\n\n      let footerHeight = this.footer.offsetHeight;\n      footerHeight += parseInt(window.getComputedStyle(this.footer).getPropertyValue('margin-top'), 10);\n      footerHeight += parseInt(window.getComputedStyle(this.footer).getPropertyValue('margin-bottom'), 10);\n\n      const padding = this.offsetTop;\n      const maxModalHeight = window.height - (padding * 2);\n      const modalBodyPadding = (bodyHeightOuter - bodyHeight);\n      const maxModalBodyHeight = maxModalHeight - (headerHeight + footerHeight + modalBodyPadding);\n\n      if (this.iframeEl) {\n        const iframeHeight = this.iframeEl.getBoundingClientRect().height;\n\n        if (iframeHeight > maxModalBodyHeight) {\n          this.container.style.maxHeight = maxModalBodyHeight;\n          this.container.style.overflowY = 'auto';\n          this.iframeEl.style.maxHeight = maxModalBodyHeight - modalBodyPadding;\n        }\n      } else if (modalHeight > maxModalHeight) {\n        this.container.style.maxHeight = maxModalBodyHeight;\n        this.container.style.overflowY = 'auto';\n      }\n    }\n\n    /* eslint-disable */\n    findAncestorByClass(el, className) {\n      while ((el = el.parentElement) && !el.classList.contains(className));\n      return el;\n    }\n    /* eslint-enable */\n  });\n})();\n"],"names":["KEYCODE","TAB","ESC","customElements","define","triggerBtn","focusableElements","focusableSelectors","container","querySelector","id","Error","title","getAttribute","setAttribute","classList","add","iframe","width","height","cont","document","createElement","innerHTML","appendChild","header","main","footer","randomId","Date","getUTCMilliseconds","htag","innerText","closeButton","insertAdjacentElement","body","addEventListener","open","bind","removeEventListener","dropShadow","removeAttribute","iframeEl","parentNode","remove","newIframe","src","adjustDimensions","scrollTop","slice","call","querySelectorAll","join","length","focus","evKeypress","keyPress","evClose","close","evDocumentClose","documentClose","modalButtons","forEach","modalButton","removeChild","event","findAncestorByClass","target","e","keyCode","focusedIndex","indexOf","activeElement","shiftKey","preventDefault","modalHeight","offsetHeight","parseInt","window","getComputedStyle","getPropertyValue","bodyHeight","getBoundingClientRect","bodyHeightOuter","headerHeight","footerHeight","padding","offsetTop","maxModalHeight","modalBodyPadding","maxModalBodyHeight","iframeHeight","style","maxHeight","overflowY","el","className","parentElement","contains","HTMLElement"],"mappings":"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"}